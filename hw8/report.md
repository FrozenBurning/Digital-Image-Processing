# 数图小作业八

2017011552 陈昭熹

## 基于texton直方图的纹理分类

### 算法实现

#### 生成滤波器组

利用matlab库函数生成包括LOG、Gauss以及高斯一阶梯度的滤波器组。其中滤波器尺寸固定为$[49\times49]$，标准差基础参数取值为$\sigma=[1,\sqrt{2},2,2\sqrt{2}]$

- LOG滤波器尺寸参数定义如上，标准差取值为$\sigma$和$3\sigma$，共$2\times4$八个参数，生成八个不同的滤波器。
- Gaussian滤波器尺寸参数定义如上，标准差取值为$\sigma$，共四个参数，生成四个不同的滤波器。
- Gradient-Gauss滤波器尺寸参数定义如上，采用$prewitt$算子直接对上面生成的高斯滤波器进行进行梯度计算，得到四个不同的滤波器。

综上，滤波器组中供16个可用滤波器。

#### 聚类

使用matlab库函数kmeans予以实现，由于数据量较大，为了其能够收敛，需要将`MaxIter`参数调大至1000。由于默认值是100，有时候会出现聚类尚未收敛算法就进入下一步骤的情况。

#### 求取texton直方图

直接对每个像素得到的聚类label进行直方图统计即可，生成一个与聚类数量维度相同的行向量，记录对应label出现次数。

#### 可视化

使用`histogram`直接绘制直方图，使用`'Colormap',jet(255)`实现texton的伪彩色显示。

### 效果

#### 不同聚类数

本小节实验仅适用滤波器组的前8个，即**仅使用LOG滤波器**.

经过改变聚类数进行不同的特征提取后发现，聚类数能够显著影响类别预测效果。聚类数过少，会导致图像特征纹理提取不充分。而聚类数过多，增加了聚类数据的复杂度，会出现类似于“过拟合”的现象，分类器无法很好的区分相对于巨大的聚类数来说，仅有简单特征的图片。换句话讲，聚类数过多超过了图像中本身的纹理种类，也会导致效果变差。
从计算效率上，聚类数增加会显著增加算法的执行时间，降低速度。
##### k=5，acc=76%
![](k=5.png)
![](k=5samples.png)

##### k=20,acc=80%
![](k=20.png)
![](k=20samples.png)

##### k=40,acc=76%
![](k=40.png)
![](k=40samples.png)

#### 改进滤波器组

本小节使用上滤波器组中剩余的Gauss滤波器和Gauss一阶梯度滤波器，得到了效果的变化。

##### 添加Gaussian滤波器,acc=76%
在8个LOG滤波器基础上，将4个Gaussian滤波器投入使用，共12个滤波器组成滤波器组进行特征提取。
可以从伪彩色特征图看出，加入了Gaussian滤波器，提取出了与前一小节不同的特征，但是这些特征并没有很好的辅助分类，反而影响了分类器判断，导致了结果下滑。

![](addgauss.png)
![](addgausssamples.png)

##### 添加Gaussian和Gradient-Gauss滤波器，acc=84%

将前文描述的全部16个滤波器均投入滤波器组使用，由于高斯梯度滤波器在空域上与LOG和Gauss滤波器有着本质的区别，因此此次应当能够再挖掘出一些图像中的深层纹理特征，从而更好的完成提取和分类。
从伪彩色特征图中可以明显看出，原图中的图像边缘被当做特征提取出来，而前文的方法结果中几乎都只有纹理特征，而这里图像边缘的信息也被提取出来，这显然为提高分类准确率提供了帮助。从直方图分布中也能直观的看出五种图片的分布差别更加明显，更具有区分度，类之间“距离”更远，这也体现了分类的更优性。
![](addgrad84acc.png)
![](addgrad84sample.png)